<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModal"
    aria-hidden="true" id="{{ $id }}">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myExtraLargeModal">{{ $title }}</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <!-- <div class="modal modal-slide-in basic-select2 fade bootstrap-select" id="{{ $id }}">
                <div class="modal-dialog sidebar-sm"> -->
            <form action="{{ route('admin.vulnerability_management.ajax.store') }}" method="POST"
                class="modal-content pt-0">
                @csrf
            @csrf
            <input type="hidden" name="id">
            <div class="modal-body flex-grow-1">
                {{-- plugin Id --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.PluginId') }}</label>
                    <input type="text" name="plugin_id" class="form-control dt-post"
                        aria-label="{{ __('locale.PluginId') }}"  {{ $isEdit ? 'disabled' : '' }}  />
                    <span class="error error-plugin_id "></span>
                </div>
                {{-- plugin Name --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.PluginName') }}</label>
                    <input type="text" name="name" class="form-control dt-post"
                        aria-label="{{ __('locale.PluginName') }}" {{ $isEdit ? 'disabled' : '' }}/>
                    <span class="error error-name "></span>
                </div>

                {{-- cve --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CVE') }}</label>
                    <input type="text" name="cve" class="form-control dt-post"
                        aria-label="{{ __('vulnerability.CVE') }}" {{ $isEdit ? 'disabled' : '' }}/>
                    <span class="error error-cve "></span>
                </div>
                {{-- Netbios Name --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.NetbiosName') }}</label>
                    <input type="text" name="netbios_name" class="form-control dt-post"
                        aria-label="{{ __('locale.NetbiosName') }}" {{ $isEdit ? 'disabled' : '' }}/>
                    <span class="error error-netbios_name "></span>
                </div>

                {{-- Dns Name --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.DnsName') }}</label>
                    <input type="text" name="dns_name" class="form-control dt-post"
                        aria-label="{{ __('locale.DnsName') }}" {{ $isEdit ? 'disabled' : '' }}/>
                    <span class="error error-dns_name "></span>
                </div>
                {{-- ip adress --}}
                <div class="mb-1">
                    <label class="form-label"> {{ __('vulnerability.IpAddress') }}</label>
                    <select name="ip_address" class="form-select multiple-select2" {{ $isEdit ? 'disabled' : '' }}>
                        <option value="" disabled hidden>{{ __('locale.select-option') }}</option>
                        <option value="no_ip">{{ __('locale.NoIpAddress') }}</option>
                        @foreach ($ips as $ip)
                            <option value="{{ $ip }}">{{ $ip }}</option>
                        @endforeach
                    </select>
                    <span class="error error-ip_address "></span>
                </div>
                

                {{-- Assets --}}
                <div class="mb-1">
                    <label class="form-label"> {{ __('vulnerability.Assets') }}</label>
                    <select name="assets[]" class="form-select multiple-select2" multiple="multiple" {{ $isEdit ? 'disabled' : '' }}>
                        <option value="" disabled hidden>{{ __('locale.select-option') }}</option>
                        {{-- @foreach ($assets as $asset)
                        <option value="{{ $asset->id }}">{{ $asset->name }}</option>
                        @endforeach --}}
                    </select>
                    <span class="error error-assets "></span>
                </div>
                {{-- asset owner --}}
                <div class="mb-1">
                    <label class="form-label"> {{ __('vulnerability.AssetOwner') }}</label>
                    <select name="asset_owner" class="form-select multiple-select2" multiple="multiple" disabled>
                        @foreach ($owners as $owner)
                            <option value="{{ $owner->id }}">{{ $owner->name }}</option>
                        @endforeach
                    </select>
                    <span class="error error-asset_owner "></span>
                </div>


                {{-- Teams --}}
                <div class="mb-1">
                    <label class="form-label"> {{ __('locale.Teams') }}</label>
                    <select name="teams[]" class="form-select multiple-select2" multiple="multiple" {{ $isEdit ? 'disabled' : '' }}>
                        <option value="" disabled hidden>{{ __('locale.select-option') }}</option>
                        @foreach ($teams as $team)
                            <option value="{{ $team->id }}">{{ $team->name }}</option>
                        @endforeach
                    </select>
                    <span class="error error-teams "></span>
                </div>
                {{-- Port --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.Port') }}</label>
                    <input type="number" min="0" step="1" name="port" class="form-control dt-post"
                        aria-label="{{ __('locale.Port') }}"  {{ $isEdit ? 'disabled' : '' }} />
                    <span class="error error-port "></span>
                </div>
                {{-- Protocol --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.Protocol') }}</label>
                    <input type="text" name="protocol" class="form-control dt-post"
                        aria-label="{{ __('locale.Protocol') }}" {{ $isEdit ? 'disabled' : '' }} />
                    <span class="error error-protocol "></span>
                </div>
                {{-- severity --}}
                <div class="mb-1">
                    <label class="form-label ">{{ __('locale.Severity') }}</label>
                    <select name="severity" class="form-select select2" style="{{ $isEdit ? 'pointer-events: none; background-color: #f1f1f1;' : '' }}">
                        <option value="" disabled hidden selected>{{ __('locale.select-option') }}</option>
                        <option value='Critical'> {{ __('locale.Critical') }}</option>
                        <option value='High'> {{ __('locale.High') }}</option>
                        <option value='Medium'> {{ __('locale.Medium') }}</option>
                        <option value='Low'> {{ __('locale.Low') }}</option>
                        <option value='Informational'> {{ __('locale.Informational') }}</option>
                    </select>
                    <span class="error error-severity"></span>
                </div>
                {{-- Exploit --}}
                <div class="mb-1">
                    <label class="form-label ">{{ __('locale.Exploit') }}</label>
                    <select name="exploit" class="form-select select2" {{ $isEdit ? 'disabled' : '' }}>
                        <option value="" disabled hidden selected>{{ __('locale.select-option') }}</option>
                        <option value='yes'> {{ __('locale.Yes') }}</option>
                        <option value='no'> {{ __('locale.No') }}</option>
                    </select>
                    <span class="error error-exploit"></span>
                </div>
                {{-- Synopsis --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.Synopsis') }}</label>
                    <textarea class="form-control" name="synopsis" rows="3" {{ $isEdit ? 'disabled' : '' }}></textarea>
                    <span class="error error-synopsis "></span>
                </div>
                {{-- description --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.Description') }}</label>
                    <textarea class="form-control" name="description" rows="3" {{ $isEdit ? 'disabled' : '' }}></textarea>
                    <span class="error error-description "></span>
                </div>
                {{-- recommendation --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.Solution') }}</label>
                    <textarea class="form-control" name="recommendation" rows="3" {{ $isEdit ? 'disabled' : '' }}></textarea>
                    <span class="error error-recommendation "></span>
                </div>
                {{-- plan --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('locale.PluginOutput') }}</label>
                    <textarea class="form-control" name="plan" rows="3" {{ $isEdit ? 'disabled' : '' }}></textarea>
                    <span class="error error-plan "></span>
                </div>
                {{-- First Discovered --}}
                <div class="mb-1">
                    <label class="form-label ">{{ __('locale.FirstDiscovered') }}</label>
                    <input name="first_discovered" class="form-control flatpickr-date-time-compliance"
                        placeholder="YYYY-MM-DD" {{ $isEdit ? 'disabled' : '' }}/>
                    <span class="error error-first_discovered"></span>
                </div>
                {{-- Last Observed --}}
                <div class="mb-1">
                    <label class="form-label ">{{ __('locale.LastObserved') }}</label>
                    <input name="last_observed" class="form-control flatpickr-date-time-compliance"
                        placeholder="YYYY-MM-DD" {{ $isEdit ? 'disabled' : '' }} />
                    <span class="error error-last_observed"></span>
                </div>
                {{-- Plugin Publication Date --}}
                <div class="mb-1">
                    <label class="form-label ">{{ __('locale.PluginPublicationDate') }}</label>
                    <input name="plugin_publication_date" class="form-control flatpickr-date-time-compliance"
                        placeholder="YYYY-MM-DD" {{ $isEdit ? 'disabled' : '' }} />
                    <span class="error error-plugin_publication_date"></span>
                </div>
                {{-- Plugin Modification Date --}}
                <div class="mb-1">
                    <label class="form-label ">{{ __('locale.PluginModificationDate') }}</label>
                    <input name="plugin_modification_date" class="form-control flatpickr-date-time-compliance"
                        placeholder="YYYY-MM-DD" {{ $isEdit ? 'disabled' : '' }} />
                    <span class="error error-plugin_modification_date"></span>
                </div>
                {{-- status --}}
                <div class="mb-1">
                    <label class="form-label ">{{ __('locale.Status') }}</label>
                    <select name="status" class="form-select select2">
                        <option value='Open' selected> {{ __('locale.Open') }}</option>
                        <option value='Closed'> {{ __('locale.Closed') }}</option>
                        <option value='In Progress'> {{ __('locale.In Progress') }}</option>
                        <option value='Overdue'> {{ __('locale.Overdue') }}</option>
                    </select>
                    <span class="error error-status"></span>
                </div>
                {{-- New Fields --}}
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.Family') }}</label>
                    <input type="text" name="family" class="form-control" {{ $isEdit ? 'disabled' : '' }} />
                    <span class="error error-family"></span>
                </div>
                 
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.ACR') }}</label>
                    <input type="text" name="acr" class="form-control" {{ $isEdit ? 'disabled' : '' }} />
                    <span class="error error-acr"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.AES') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="aes" class="form-control" />
                    <span class="error error-aes"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.Repository') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="repository" class="form-control" />
                    <span class="error error-repository"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.MACAddress') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="mac_address" class="form-control" />
                    <span class="error error-mac_address"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.PluginOutput') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="plugin_output" class="form-control" />
                    <span class="error error-plugin_output"></span>
                </div>
              
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.StepsToRemediate') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="steps_to_remediate" class="form-control" />
                    <span class="error error-steps_to_remediate"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.SeeAlso') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="see_also" class="form-control" />
                    <span class="error error-see_also"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.RiskFactor') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="risk_factor" class="form-control" />
                    <span class="error error-risk_factor"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.STIGSeverity') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="stig_severity" class="form-control" />
                    <span class="error error-stig_severity"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.VulnPriorityRating') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="vuln_priority_rating" class="form-control" />
                    <span class="error error-vuln_priority_rating"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CVSSV2') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="cvss_v2" class="form-control" />
                    <span class="error error-cvss_v2"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CVSSV3') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="cvss_v3" class="form-control" />
                    <span class="error error-cvss_v3"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CVSSV2TemporalScore') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="cvss_v2_temporal_score" class="form-control" />
                    <span class="error error-cvss_v2_temporal_score"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CVSSV3TemporalScore') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="cvss_v3_temporal_score" class="form-control" />
                    <span class="error error-cvss_v3_temporal_score"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CVSSV2Vector') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="cvss_v2_vector" class="form-control" />
                    <span class="error error-cvss_v2_vector"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CPE') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="cpe" class="form-control" />
                    <span class="error error-cpe"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.Bid') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="bid" class="form-control" />
                    <span class="error error-bid"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CrossReference') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="cross_reference" class="form-control" />
                    <span class="error error-cross_reference"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.SeverityEndOfLife') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="severity_end_of_life" class="form-control" />
                    <span class="error error-severity_end_of_life"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.PatchPublication') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="patch_publication" class="form-control" />
                    <span class="error error-patch_publication"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.PlusModification') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="plus_modification" class="form-control" />
                    <span class="error error-plus_modification"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.ExploitEase') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="exploit_ease" class="form-control" />
                    <span class="error error-exploit_ease"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.ExploitFramework') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="exploit_framework" class="form-control" />
                    <span class="error error-exploit_framework"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.CheckType') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="check_type" class="form-control" />
                    <span class="error error-check_type"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.Version') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="version" class="form-control" />
                    <span class="error error-version"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.RecastRiskComment') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="recast_risk_comment" class="form-control" />
                    <span class="error error-recast_risk_comment"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.AgentID') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="agent_id" class="form-control" />
                    <span class="error error-agent_id"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.Service') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="service" class="form-control" />
                    <span class="error error-service"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.Department') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="department" class="form-control" />
                    <span class="error error-department"></span>
                </div>
                <div class="mb-1">
                    <label class="form-label">{{ __('vulnerability.System') }}</label>
                    <input type="text" {{ $isEdit ? 'disabled' : '' }} name="system" class="form-control" />
                    <span class="error error-system"></span>
                </div>
                <button type="Submit" class="btn btn-primary data-submit me-1"> {{ __('locale.Submit') }}</button>
                <button type="reset" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                    {{ __('locale.Cancel') }}</button>
            </div>
            </form>
        </div>
    </div>
</div>
